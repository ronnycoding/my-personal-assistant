prompt = "Scan Apple Mail inbox for the last 48 hours and extract actionable intelligence with professional context awareness, focusing on job opportunities, urgent items, and time-sensitive requests."
description = "Apple Mail inbox scanning and triage using AppleScript"
command = "osascript .gemini/scripts/scan_inbox.scpt 48 false"
instruction = """## Phase 1: Data Collection

Execute the email scanning script to gather inbox data:

```bash
osascript .gemini/scripts/scan_inbox.scpt 48 false
```

## Phase 2: Intelligence Extraction & Categorization

Analyze each email and categorize based on the following priority matrix:

### üî¥ CRITICAL - Job Opportunities (Priority Score: 100)
**Detection Keywords:**
- Role indicators: "interview", "position", "role", "opportunity", "career", "hiring", "application", "candidate"
- Seniority levels: "Principal", "Senior", "Staff", "Lead", "Architect"
- Engineering roles: "Engineer", "Developer", "Architect", "Technical Lead"

**Extraction Requirements:**
- Company name (from sender domain or subject)
- Role title (exact phrase)
- Sender name and email address
- Action required (interview, application, response)
- Received timestamp

**Exclusions:**
- Generic job board digests (Torre bulk emails, LinkedIn daily digests)
- "Apply now" promotional emails without specific role
- Job alerts with dozens of listings (bulk newsletters)

**Professional Context Filters:**
- Prioritize: Python, Backend, Cloud, AI/ML, Distributed Systems
- Seniority match: Principal, Senior, Staff levels
- Work style: Remote-first or hybrid opportunities
- De-prioritize: Junior, Entry-level, Intern positions

---

### üî¥ URGENT - Time-Sensitive Items (Priority Score: 90)
**Detection Keywords:**
- Urgency: "urgent", "ASAP", "immediate", "critical", "important"
- Deadlines: "expires", "deadline", "due by", "expires in [N] days", "by [date]"
- Action required: "action required", "please respond", "needs approval", "approval needed"

**Extraction Requirements:**
- What's due or expiring
- Deadline date/time (if present)
- Who requested it
- Consequences of missing deadline

---

### üü° IMPORTANT - Meeting Requests (Priority Score: 70)
**Detection Keywords:**
- Meeting: "meeting", "schedule", "calendar", "availability", "invite"
- Calls: "call", "sync", "catchup", "1:1", "discussion"
- Events: "webinar", "conference", "presentation"

**Extraction Requirements:**
- Meeting purpose
- Participants or organizer
- Proposed times (if any)
- Response deadline

---

### üü° IMPORTANT - Financial Items (Priority Score: 70)
**Detection Keywords:**
- Financial: "payment", "invoice", "billing", "subscription"
- Actions: "withdraw", "renewal", "expires", "domain"
- Accounts: "account", "funds", "balance", "statement"

**Extraction Requirements:**
- Service or account affected
- Amount (if present)
- Due date or expiration
- Action required

---

### üü¢ INFORMATIONAL - Work Updates (Priority Score: 50)
**Sources:** Jira, Confluence, GitHub, Slack, project management tools

**Detection Keywords:**
- Platforms: "Jira", "Confluence", "GitHub", "GitLab", "Trello"
- Notifications: "mentioned you", "assigned to you", "due", "updated", "commented"

**Extraction Requirements:**
- Platform name
- Notification type
- Action required (if any)

---

### ‚ö™ LOW PRIORITY - Newsletters/Promotional (Priority Score: 20)
**Indicators:**
- Mass emails (generic greetings, unsubscribe links)
- Tech news digests (daily/weekly roundups)
- Marketing emails (promotional offers, discounts)
- Social media notifications (likes, follows, etc.)

**Action:** Flag as batch-processable, group by type

---

## Phase 3: Priority Scoring Algorithm

For each email, calculate a total priority score (0-100):

1. **Base Score** (from category above)
2. **Professional Relevance** (+20 points):
   - Contains: Python, FastAPI, Django, Backend, Cloud, AWS, Kubernetes, AI, ML, RAG, LLM
3. **Seniority Match** (+15 points):
   - Role includes: Principal, Senior, Staff (matching career level)
4. **Time Sensitivity** (+10 points):
   - Deadline within 48 hours
   - Expires soon
5. **Sender Reputation** (+10 points):
   - Direct recruiter (not job board)
   - Known company (tech companies, startups)
   - Human sender (not noreply@)

**Final Sort:** Descending by total score

---

## Phase 4: Structured Presentation

Present the analysis in this format:

```markdown
üì¨ INBOX INTELLIGENCE (N unread, 48h scan)

## üî¥ CRITICAL ACTIONS (N items)

### üéØ JOB OPPORTUNITIES
‚Ä¢ **[Role Title] - [Company]**
  From: [Sender Name] <email>
  Received: [Time]
  Score: [Priority Score]/100
  Action: [What needs to be done]
  Relevance: [Why this matters - tech stack, seniority, etc.]

[Additional job opportunities...]

### ‚è∞ URGENT / TIME-SENSITIVE
‚Ä¢ **[Subject or Description]**
  From: [Sender]
  Deadline: [Date/Time]
  Action: [What's required]

[Additional urgent items...]

---

## üü° IMPORTANT (N items)

### üíº MEETING REQUESTS
[List meeting invites...]

### üí≥ FINANCIAL ITEMS
[List financial actions...]

---

## üü¢ WORK UPDATES (N items)
‚Ä¢ Jira: [Count] notifications
‚Ä¢ Confluence: [Count] mentions
‚Ä¢ GitHub: [Count] updates

---

## ‚ö™ NEWSLETTERS/PROMOTIONAL (N items)
‚Ä¢ Tech News: [Count] items ([Sources...])
‚Ä¢ Promotional: [Count] items
‚Ä¢ Social: [Count] items
**Recommendation:** Batch-process during downtime

---

## üí° RECOMMENDED ACTIONS (Priority Order)
1. üéØ **PRIORITY**: [Highest priority action - typically job opportunity]
2. ‚è∞ **URGENT**: [Time-sensitive items]
3. üìù **IMPORTANT**: [Meeting responses, work items]
4. üí≥ **FINANCIAL**: [Renewals, payments]
5. üì∞ **OPTIONAL**: Batch-process newsletters

---

## üìä INBOX SUMMARY
‚Ä¢ **Actionable Items:** [Count] (require immediate attention)
‚Ä¢ **Job Opportunities:** [Count]
‚Ä¢ **Urgent Deadlines:** [Count]
‚Ä¢ **Work Notifications:** [Count]
‚Ä¢ **Can Wait:** [Count]

Would you like me to:
- Draft a response to any specific email?
- Get more details about a particular item?
- Set reminders for time-sensitive actions?
- Create calendar blocks for email processing?
"""